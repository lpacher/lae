#############################################################################
##
## A first Makefile example to automate FPGA implementation and programming
## flows using Xilinx Vivado Tcl scripts.
##
## Luca Pacher - pacher@to.infn.it
## Spring 2024
##
#############################################################################


## some useful aliases
RM := rm -f -v
RMDIR := rm -rf -v


## run RTL to bitstream generation flows using a Project Mode Tcl script
.PHONY : build
build : build.tcl

	@vivado -mode batch -source build.tcl -notrace -log build.log -nojournal


## install bitstream to Arty board (Hardware Manager)
.PHONY : install
install : install.tcl

	@vivado -mode batch -source install.tcl -notrace -log install.log -nojournal


## delete all log files and project files generated by Vivado flows
.PHONY : clean
clean :

	@$(RM) *.log *.jou *.str *.xpr *.bit *.bin
	@$(RMDIR) *.cache *.hw *.ip_user_files *.runs *.sim *.srcs .Xil
